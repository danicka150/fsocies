<h2>Регистрация</h2>
<form id="registerForm">
  <input type="text" name="nickname" placeholder="Ник" required>
  <input type="password" name="password" placeholder="Пароль" required>
  <button type="submit">Регистрация</button>
</form>

<h2>Вход</h2>
<form id="loginForm">
  <input type="text" name="nickname" placeholder="Ник" required>
  <input type="password" name="password" placeholder="Пароль" required>
  <button type="submit">Войти</button>
</form>

<div id="message"></div>

<script>
const message = document.getElementById("message");

// Регистрация
document.getElementById("registerForm").addEventListener("submit", async e => {
  e.preventDefault();
  const form = e.target;
  const res = await fetch("/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ nickname: form.nickname.value, password: form.password.value })
  });
  const data = await res.json();
  if(data.success) {
    window.location.href = "/feed.html";
  } else message.innerText = data.error;
});

// Логин
document.getElementById("loginForm").addEventListener("submit", async e => {
  e.preventDefault();
  const form = e.target;
  const res = await fetch("/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ nickname: form.nickname.value, password: form.password.value })
  });
  const data = await res.json();
  if(data.success) window.location.href = "/feed.html";
  else message.innerText = data.error;
});
</script>

